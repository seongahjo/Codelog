+++
categories = ["아키텍처"]
date = "2018-09-28T22:49:30+00:00"
description = ""
draft = true
tags = ["Microservice", "MSA"]
title = "마이크로 서비스 아키텍쳐"

+++
### 마이크로 서비스 아키텍처

#### 필요한 경우

1. 서비스에 대한 로드맵이 명확한 경우
2. 애플리케이션 배포에 한 시간 이상이 걸린다.
3. 단순한 기능 하나를 수정해도 전체 기능에 대한 QA가 필요하다.
4. 단순한 버그 수정이 더 중대한 버그를 생산하는 일이 많아진다.
5. 현재의 애플리케이션을 기능 별로 나눈다고 가정했을 때 수십 개의 마이크로서비스가 가능하다.

#### 모놀리틱 아키텍처

![](/uploads/1.png)

##### 특징

* 비지니스 로직을 담당하는 애플리케이션이 존재한다.
* 해당 애플리케이션이 데이터베이스 등 외부 시스템과 특정 프로토콜로 통신한다.
* 사용자에게 인터페이스를 제공하기 위해 HTML, REST API를 제공한다.

5명 이하의 개발자들이 있는 상황에서는 최적의 효율성을 보장하지만 규모가 수십 명, 수백 명이 되고 서비스의 복잡도가 증가되면 간단한 기능을 추가하는데 어려움이 많아진다. 많은 코드를 수정해야하고 코드의 변화가 영향을 미치는 범위가 커져서 통합 테스트가 필요하게 된다.

##### 문제점

* 배포 시간 증가
* 부분적 스케일 아웃의 어려움
* 안정성 감소
* 프로그래밍 언어, 프레임워크의 변경 불가

#### 마이크로서비스

##### API Gateway

![](/uploads/2.png)

API Gateway를 통해 정보를 웹페이지에 표시하거나 모바일 클라이언트에 데이터를 제공한다. 각 서비스간 REST API를 통해 통신한다.

사용자를 위한 데이터베이스와 주문을 위한 데이터베이스가 별도로 존재한다. 또한 DBMS의 종류를 한 가지로 통일할 필요가 없다. 반면에 모놀리틱 아키텍처에서는 한 가지 데이터베이스를 사용하여 데이터의 트랜잭션 관리, 정규화 등을 처리한다.

##### 장점

* 변경이 용이하고 변경이 다른 서비스에 미치는 영향이 적다
* 개별 서비스 단위의 배포가 가능하기 때문에 여러 번 배포가 가능하다
* 효율적인 자원이 사용 가능하다.

##### 단점

* 서비스간 통신에 대한 처리가 추가적으로 필요하다
* 사용자 요청을 처리하기 위해 응답속도가 증가한다
* 서비스가 분산되있어 관리가 어렵다

##### API Gateway

> 서비스로 전달되는 모든 API 요청의 관문(Gateway) 역할을 하는 서버

시스템의 아키텍처를 내부로 숨기고 외부의 요청에 대한 응답만을 적합한 형태로 응답한다.

API Gateway는 클라이언트의 요청을 일괄적으로 처리할 뿐만 아니라 전체 시스템의 부하를 분산시키는 **로드 밸런서**, 동일한 요청에 대한 불필요한 반복 작업을 줄일 수 있는 **캐싱**, 시스템상 오고가는 요청과 응답에 대한 **모니터링** 역할도 수행할 수 있다.

하지만 구현하고 관리해야하는 요소가 하나 더 증가한다. 또한 성능상의 병목지점이 될 수 있다. 따라서 API Gate를 설계하고 구현할 때는 성능과 확장성을 고려해야 한다.

###### 용어

* End Point
* API Gateway
* 모놀리틱 아키텍처
* 마이크로 서비스 아키텍처
* AWS Elastic LoadBalancer